<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="709px" preserveAspectRatio="none" style="width:1104px;height:709px;" version="1.1" viewBox="0 0 1104 709" width="1104px" zoomAndPan="magnify"><defs><filter height="300%" id="f1v9rt1oragoz0" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--class SqlSessionFactory--><rect fill="#FEFECE" filter="url(#f1v9rt1oragoz0)" height="63.0229" id="SqlSessionFactory" style="stroke: #A80036; stroke-width: 1.5;" width="161" x="258" y="23"/><ellipse cx="285.15" cy="39" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M282.15,35 L282.15,33.3125 L287.8375,33.3125 L287.8375,35 L286.0563,35 Q285.9156,35 285.8766,35.0234 Q285.8375,35.0469 285.8375,35.1094 L285.8375,43.2031 Q285.8375,43.2656 285.8766,43.2891 Q285.9156,43.3125 286.0563,43.3125 L287.8375,43.3125 L287.8375,45 L282.15,45 L282.15,43.3125 L283.9313,43.3125 Q284.1188,43.3125 284.1344,43.2969 Q284.15,43.2813 284.15,43.2031 L284.15,35.1094 Q284.15,35.0313 284.1344,35.0156 Q284.1188,35 283.9313,35 L282.15,35 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="102" x="301.85" y="44.5576">SqlSessionFactory</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="259" x2="418" y1="55" y2="55"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="259" x2="418" y1="63" y2="63"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="149" x="264" y="79.606">SqlSession openSession(xxx);</text><!--class DefaultSqlSessionFactory--><rect fill="#FEFECE" filter="url(#f1v9rt1oragoz0)" height="78.0459" id="DefaultSqlSessionFactory" style="stroke: #A80036; stroke-width: 1.5;" width="255" x="211" y="161"/><ellipse cx="263.25" cy="177" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M262.9375,183 Q261,183 259.875,181.5703 Q258.75,180.1406 258.75,177.1875 Q258.75,174.6875 259.9531,173 Q261.1563,171.3125 263.2344,171.3125 Q263.75,171.3125 264.1953,171.4766 Q264.6406,171.6406 264.8906,171.6406 Q265.0781,171.6406 265.1563,171.6094 Q265.2344,171.5781 265.7813,170.7031 L266.4844,174.7656 L265.5,175.0781 Q265.0313,173.9063 264.4531,173.4531 Q263.875,173 262.9688,173 Q261.7969,173 261.1172,174.1797 Q260.4375,175.3594 260.4375,177.1875 Q260.4375,179.3125 261.0156,180.3125 Q261.5938,181.3125 262.8906,181.3125 Q263.8281,181.3125 264.4844,180.8359 Q265.1406,180.3594 265.4844,179.1875 L266.5,179.625 Q266.0938,181.25 265.1563,182.125 Q264.2188,183 262.9375,183 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="142" x="283.75" y="182.5576">DefaultSqlSessionFactory</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="212" x2="465" y1="193" y2="193"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="217" y="209.606">Configuration configuration;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="212" x2="465" y1="216.0229" y2="216.0229"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="243" x="217" y="232.6289">SqlSession openSession(configuration, executor);</text><!--class Configuration--><rect fill="#FEFECE" filter="url(#f1v9rt1oragoz0)" height="123.1147" id="Configuration" style="stroke: #A80036; stroke-width: 1.5;" width="391" x="6" y="299"/><ellipse cx="160.25" cy="315" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M159.9375,321 Q158,321 156.875,319.5703 Q155.75,318.1406 155.75,315.1875 Q155.75,312.6875 156.9531,311 Q158.1563,309.3125 160.2344,309.3125 Q160.75,309.3125 161.1953,309.4766 Q161.6406,309.6406 161.8906,309.6406 Q162.0781,309.6406 162.1563,309.6094 Q162.2344,309.5781 162.7813,308.7031 L163.4844,312.7656 L162.5,313.0781 Q162.0313,311.9063 161.4531,311.4531 Q160.875,311 159.9688,311 Q158.7969,311 158.1172,312.1797 Q157.4375,313.3594 157.4375,315.1875 Q157.4375,317.3125 158.0156,318.3125 Q158.5938,319.3125 159.8906,319.3125 Q160.8281,319.3125 161.4844,318.8359 Q162.1406,318.3594 162.4844,317.1875 L163.5,317.625 Q163.0938,319.25 162.1563,320.125 Q161.2188,321 159.9375,321 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="180.75" y="320.5576">Configuration</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="396" y1="331" y2="331"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="12" y="347.606">Collection xxx;//配置节点</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="396" y1="354.0229" y2="354.0229"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="379" x="12" y="370.6289">Executor newExecutor(Transaction transaction, ExecutorType executorType);</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="224" x="12" y="385.6519">StatementHandler newStatementHandler(xxx);</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="220" x="12" y="400.6748">ResultSetHandler newResultSetHandler(xxx);</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="226" x="12" y="415.6978">ParameterHandler newParameterHandler(xxx);</text><!--class DefaultSqlSession--><rect fill="#FEFECE" filter="url(#f1v9rt1oragoz0)" height="93.0688" id="DefaultSqlSession" style="stroke: #A80036; stroke-width: 1.5;" width="267" x="507" y="8"/><ellipse cx="584.75" cy="24" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M584.4375,30 Q582.5,30 581.375,28.5703 Q580.25,27.1406 580.25,24.1875 Q580.25,21.6875 581.4531,20 Q582.6563,18.3125 584.7344,18.3125 Q585.25,18.3125 585.6953,18.4766 Q586.1406,18.6406 586.3906,18.6406 Q586.5781,18.6406 586.6563,18.6094 Q586.7344,18.5781 587.2813,17.7031 L587.9844,21.7656 L587,22.0781 Q586.5313,20.9063 585.9531,20.4531 Q585.375,20 584.4688,20 Q583.2969,20 582.6172,21.1797 Q581.9375,22.3594 581.9375,24.1875 Q581.9375,26.3125 582.5156,27.3125 Q583.0938,28.3125 584.3906,28.3125 Q585.3281,28.3125 585.9844,27.8359 Q586.6406,27.3594 586.9844,26.1875 L588,26.625 Q587.5938,28.25 586.6563,29.125 Q585.7188,30 584.4375,30 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="103" x="605.25" y="29.5576">DefaultSqlSession</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="508" x2="773" y1="40" y2="40"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="241" x="513" y="56.606">Configuration configuration;//封装mapper中的节点</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="255" x="513" y="71.6289">Executor executor;//执行器，生成sql，获得查询结果</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="508" x2="773" y1="78.0459" y2="78.0459"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="513" y="94.6519">List&lt;E&gt; selectList(xxx);</text><!--class CachingExecutor--><rect fill="#FEFECE" filter="url(#f1v9rt1oragoz0)" height="78.0459" id="CachingExecutor" style="stroke: #A80036; stroke-width: 1.5;" width="248" x="569.5" y="161"/><ellipse cx="642.75" cy="177" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M642.4375,183 Q640.5,183 639.375,181.5703 Q638.25,180.1406 638.25,177.1875 Q638.25,174.6875 639.4531,173 Q640.6563,171.3125 642.7344,171.3125 Q643.25,171.3125 643.6953,171.4766 Q644.1406,171.6406 644.3906,171.6406 Q644.5781,171.6406 644.6563,171.6094 Q644.7344,171.5781 645.2813,170.7031 L645.9844,174.7656 L645,175.0781 Q644.5313,173.9063 643.9531,173.4531 Q643.375,173 642.4688,173 Q641.2969,173 640.6172,174.1797 Q639.9375,175.3594 639.9375,177.1875 Q639.9375,179.3125 640.5156,180.3125 Q641.0938,181.3125 642.3906,181.3125 Q643.3281,181.3125 643.9844,180.8359 Q644.6406,180.3594 644.9844,179.1875 L646,179.625 Q645.5938,181.25 644.6563,182.125 Q643.7188,183 642.4375,183 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="93" x="663.25" y="182.5576">CachingExecutor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="570.5" x2="816.5" y1="193" y2="193"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="575.5" y="209.606">Executor delegate;//这才是真正的执行器</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="570.5" x2="816.5" y1="216.0229" y2="216.0229"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="236" x="575.5" y="232.6289">List&lt;E&gt; query(xxx);//执行delegate里的query方法</text><!--class SimpleExecutor--><rect fill="#FEFECE" filter="url(#f1v9rt1oragoz0)" height="78.0459" id="SimpleExecutor" style="stroke: #A80036; stroke-width: 1.5;" width="661" x="432" y="321.5"/><ellipse cx="715.25" cy="337.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M714.9375,343.5 Q713,343.5 711.875,342.0703 Q710.75,340.6406 710.75,337.6875 Q710.75,335.1875 711.9531,333.5 Q713.1563,331.8125 715.2344,331.8125 Q715.75,331.8125 716.1953,331.9766 Q716.6406,332.1406 716.8906,332.1406 Q717.0781,332.1406 717.1563,332.1094 Q717.2344,332.0781 717.7813,331.2031 L718.4844,335.2656 L717.5,335.5781 Q717.0313,334.4063 716.4531,333.9531 Q715.875,333.5 714.9688,333.5 Q713.7969,333.5 713.1172,334.6797 Q712.4375,335.8594 712.4375,337.6875 Q712.4375,339.8125 713.0156,340.8125 Q713.5938,341.8125 714.8906,341.8125 Q715.8281,341.8125 716.4844,341.3359 Q717.1406,340.8594 717.4844,339.6875 L718.5,340.125 Q718.0938,341.75 717.1563,342.625 Q716.2188,343.5 714.9375,343.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="86" x="735.75" y="343.0576">SimpleExecutor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="433" x2="1092" y1="353.5" y2="353.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="433" x2="1092" y1="361.5" y2="361.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="310" x="438" y="378.106">//ms中包含configuration;configuration中生成statementHandler;()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="649" x="438" y="393.1289">List&lt;E&gt; doQuery(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, BoundSql boundSql);</text><!--class PreparedStatementHandler--><rect fill="#FEFECE" filter="url(#f1v9rt1oragoz0)" height="108.0918" id="PreparedStatementHandler" style="stroke: #A80036; stroke-width: 1.5;" width="371" x="577" y="482"/><ellipse cx="682.75" cy="498" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M682.4375,504 Q680.5,504 679.375,502.5703 Q678.25,501.1406 678.25,498.1875 Q678.25,495.6875 679.4531,494 Q680.6563,492.3125 682.7344,492.3125 Q683.25,492.3125 683.6953,492.4766 Q684.1406,492.6406 684.3906,492.6406 Q684.5781,492.6406 684.6563,492.6094 Q684.7344,492.5781 685.2813,491.7031 L685.9844,495.7656 L685,496.0781 Q684.5313,494.9063 683.9531,494.4531 Q683.375,494 682.4688,494 Q681.2969,494 680.6172,495.1797 Q679.9375,496.3594 679.9375,498.1875 Q679.9375,500.3125 680.5156,501.3125 Q681.0938,502.3125 682.3906,502.3125 Q683.3281,502.3125 683.9844,501.8359 Q684.6406,501.3594 684.9844,500.1875 L686,500.625 Q685.5938,502.25 684.6563,503.125 Q683.7188,504 682.4375,504 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="151" x="703.25" y="503.5576">PreparedStatementHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="578" x2="947" y1="514" y2="514"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="205" x="583" y="530.606">TypeHandlerRegistry typeHandlerRegistry;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="359" x="583" y="545.6289">ResultSetHandler resultSetHandler;//这三个属性都是通过configuration生成</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="178" x="583" y="560.6519">ParameterHandler parameterHandler;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="578" x2="947" y1="567.0688" y2="567.0688"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="277" x="583" y="583.6748">query(Statement statement, ResultHandler resultHandler);</text><!--class DefaultResultSetHandler--><rect fill="#FEFECE" filter="url(#f1v9rt1oragoz0)" height="48" id="DefaultResultSetHandler" style="stroke: #A80036; stroke-width: 1.5;" width="169" x="575" y="650"/><ellipse cx="590" cy="666" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M589.6875,672 Q587.75,672 586.625,670.5703 Q585.5,669.1406 585.5,666.1875 Q585.5,663.6875 586.7031,662 Q587.9063,660.3125 589.9844,660.3125 Q590.5,660.3125 590.9453,660.4766 Q591.3906,660.6406 591.6406,660.6406 Q591.8281,660.6406 591.9063,660.6094 Q591.9844,660.5781 592.5313,659.7031 L593.2344,663.7656 L592.25,664.0781 Q591.7813,662.9063 591.2031,662.4531 Q590.625,662 589.7188,662 Q588.5469,662 587.8672,663.1797 Q587.1875,664.3594 587.1875,666.1875 Q587.1875,668.3125 587.7656,669.3125 Q588.3438,670.3125 589.6406,670.3125 Q590.5781,670.3125 591.2344,669.8359 Q591.8906,669.3594 592.2344,668.1875 L593.25,668.625 Q592.8438,670.25 591.9063,671.125 Q590.9688,672 589.6875,672 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="137" x="604" y="671.5576">DefaultResultSetHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="576" x2="743" y1="682" y2="682"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="576" x2="743" y1="690" y2="690"/><!--class DefaultParameterHandler--><rect fill="#FEFECE" filter="url(#f1v9rt1oragoz0)" height="48" id="DefaultParameterHandler" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="779" y="650"/><ellipse cx="794" cy="666" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M793.6875,672 Q791.75,672 790.625,670.5703 Q789.5,669.1406 789.5,666.1875 Q789.5,663.6875 790.7031,662 Q791.9063,660.3125 793.9844,660.3125 Q794.5,660.3125 794.9453,660.4766 Q795.3906,660.6406 795.6406,660.6406 Q795.8281,660.6406 795.9063,660.6094 Q795.9844,660.5781 796.5313,659.7031 L797.2344,663.7656 L796.25,664.0781 Q795.7813,662.9063 795.2031,662.4531 Q794.625,662 793.7188,662 Q792.5469,662 791.8672,663.1797 Q791.1875,664.3594 791.1875,666.1875 Q791.1875,668.3125 791.7656,669.3125 Q792.3438,670.3125 793.6406,670.3125 Q794.5781,670.3125 795.2344,669.8359 Q795.8906,669.3594 796.2344,668.1875 L797.25,668.625 Q796.8438,670.25 795.9063,671.125 Q794.9688,672 793.6875,672 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="141" x="808" y="671.5576">DefaultParameterHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="780" x2="951" y1="682" y2="682"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="780" x2="951" y1="690" y2="690"/><!--link SqlSessionFactory to DefaultSqlSessionFactory--><path d="M338.5,106.491 C338.5,124.394 338.5,144.184 338.5,160.85 " fill="none" id="SqlSessionFactory-DefaultSqlSessionFactory" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="331.5,106.284,338.5,86.284,345.5,106.284,331.5,106.284" style="stroke: #A80036; stroke-width: 1.0;"/><!--link DefaultSqlSessionFactory to Configuration--><path d="M296.72,249.337 C283.206,264.972 268.046,282.51 253.865,298.917 " fill="none" id="DefaultSqlSessionFactory-Configuration" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="305.336,239.368,298.3861,241.2911,297.4882,248.4461,304.4382,246.523,305.336,239.368" style="stroke: #A80036; stroke-width: 1.0;"/><!--link DefaultSqlSession to DefaultSqlSessionFactory--><path d="M539.747,103.375 C500.304,122.116 455.698,143.312 418.522,160.976 " fill="none" id="DefaultSqlSession-DefaultSqlSessionFactory" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="544.53,101.101,534.6843,101.3507,540.0139,103.2469,538.1177,108.5765,544.53,101.101" style="stroke: #A80036; stroke-width: 1.0;"/><!--link DefaultSqlSession to CachingExecutor--><path d="M657.415,101.299 C663.895,118.843 671.258,138.78 677.636,156.048 " fill="none" id="DefaultSqlSession-CachingExecutor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="679.407,160.843,680.0435,151.0147,677.6758,156.1523,672.5383,153.7846,679.407,160.843" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CachingExecutor to SimpleExecutor--><path d="M710.203,239.368 C720.373,262.731 733.386,292.621 743.886,316.741 " fill="none" id="CachingExecutor-SimpleExecutor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="745.951,321.485,746.0273,311.6364,743.9558,316.9004,738.6918,314.8288,745.951,321.485" style="stroke: #A80036; stroke-width: 1.0;"/><!--link SimpleExecutor to PreparedStatementHandler--><path d="M762.5,399.575 C762.5,422.206 762.5,451.372 762.5,476.837 " fill="none" id="SimpleExecutor-PreparedStatementHandler" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="762.5,481.878,766.5,472.878,762.5,476.878,758.5,472.878,762.5,481.878" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PreparedStatementHandler to DefaultResultSetHandler--><path d="M722.087,590.36 C707.766,609.2704 692.243,629.7659 680.24,645.6152 " fill="none" id="PreparedStatementHandler-DefaultResultSetHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="676.952,649.9571,685.5746,645.1978,679.9709,645.9713,679.1974,640.3676,676.952,649.9571" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PreparedStatementHandler to DefaultParameterHandler--><path d="M802.913,590.36 C817.234,609.2704 832.757,629.7659 844.76,645.6152 " fill="none" id="PreparedStatementHandler-DefaultParameterHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="848.048,649.9571,845.8026,640.3676,845.0291,645.9713,839.4254,645.1978,848.048,649.9571" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
interface SqlSessionFactory{
    SqlSession openSession(xxx);
}
class DefaultSqlSessionFactory{
    Configuration configuration;
    SqlSession openSession(configuration, executor);
}
class Configuration{
    Collection xxx;//配置节点
    Executor newExecutor(Transaction transaction, ExecutorType executorType);
    StatementHandler newStatementHandler(xxx);
    ResultSetHandler newResultSetHandler(xxx);
    ParameterHandler newParameterHandler(xxx);
}
class DefaultSqlSession{
    Configuration configuration;//封装mapper中的节点
    Executor executor;//执行器，生成sql，获得查询结果
    List<E> selectList(xxx);
}
class CachingExecutor{
    Executor delegate;//这才是真正的执行器
    List<E> query(xxx);//执行delegate里的query方法
}
class SimpleExecutor{
    //ms中包含configuration;configuration中生成statementHandler;()
    List<E> doQuery(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, BoundSql boundSql);
}
class PreparedStatementHandler{
    TypeHandlerRegistry typeHandlerRegistry;
    ResultSetHandler resultSetHandler;//这三个属性都是通过configuration生成
    ParameterHandler parameterHandler;
    query(Statement statement, ResultHandler resultHandler);
}
class DefaultResultSetHandler{

}
class DefaultParameterHandler{

}

SqlSessionFactory <|.. DefaultSqlSessionFactory
DefaultSqlSessionFactory o- - Configuration
DefaultSqlSession <.. DefaultSqlSessionFactory
DefaultSqlSession  - -> CachingExecutor
CachingExecutor - -> SimpleExecutor
SimpleExecutor ..> PreparedStatementHandler
PreparedStatementHandler - -> DefaultResultSetHandler
PreparedStatementHandler - -> DefaultParameterHandler
@enduml

PlantUML version 1.2017.15(Tue Jul 04 00:45:34 CST 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-915-b12
Operating System: Windows 7
OS Version: 6.1
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg>